<!DOCTYPE html>
<html lang="ko">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>Eclipso</title>

    <!-- Tailwind -->
    <script src="https://cdn.tailwindcss.com"></script>

    <!-- Markdown renderer + sanitizer -->
    <script src="https://cdn.jsdelivr.net/npm/marked/marked.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/dompurify@3.3.1/dist/purify.min.js"></script>

    <script>
      // API_BASE 자동 설정
      const origin = window.location.origin
      window.API_BASE =
        origin.includes('127.0.0.1') || origin.includes('localhost')
          ? 'http://127.0.0.1:8000'
          : origin.replace(/\/$/, '')
    </script>

    <style>
      :root {
        --bg: #fafafa;
        --panel: #ffffff;
        --panel-muted: #f8fafc;
        --border: #e5e7eb;
        --border-strong: #d1d5db;
        --text: #111827;
        --muted: #6b7280;
        --brand: #4f46e5;
        --brand-dark: #4338ca;
        --ring: rgba(79, 70, 229, 0.28);
      }

      /* MD 기본 */
      .doc-md {
        font-family: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto,
          Apple SD Gothic Neo, Noto Sans KR, 'Malgun Gothic', Arial,
          'Apple Color Emoji', 'Segoe UI Emoji';
        font-size: 13px;
        line-height: 1.55;
        color: var(--text);
      }
      .doc-md pre,
      .doc-md code {
        font-family: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas,
          'Liberation Mono', 'Courier New', monospace;
        font-size: 12px;
      }
      .doc-md pre {
        background: #0b1220;
        color: #e5e7eb;
        padding: 12px;
        border-radius: 12px;
        overflow: auto;
        border: 1px solid rgba(229, 231, 235, 0.12);
      }
      .doc-md table {
        width: 100%;
        border-collapse: collapse;
        margin: 10px 0;
        font-size: 12px;
      }
      .doc-md th,
      .doc-md td {
        border: 1px solid var(--border);
        padding: 6px 8px;
        vertical-align: top;
      }
      .doc-md thead th {
        background: var(--panel-muted);
        color: var(--text);
        font-weight: 700;
      }

      /* 탐지 하이라이트 */
      .pii-box {
        --pii-bg: rgba(79, 70, 229, 0.1);
        --pii-bd: #4f46e5;

        position: relative;
        display: inline;
        padding: 0 2px;
        border-radius: 6px;
        background: var(--pii-bg);
        box-shadow: inset 0 0 0 2px var(--pii-bd);
        cursor: pointer;
      }
      .pii-box.pii-fail {
        --pii-bg: rgba(107, 114, 128, 0.1);
        --pii-bd: #6b7280;
        opacity: 0.72;
      }
      .pii-box.pii-selected {
        outline: 3px solid var(--ring);
        outline-offset: 2px;
      }
      .pii-box::after {
        content: attr(data-tag);
        display: inline-block;
        margin-left: 6px;
        padding: 1px 6px;
        border-radius: 999px;
        font-size: 10px;
        line-height: 1.4;
        font-weight: 700;
        vertical-align: 2px;
        background: rgba(17, 24, 39, 0.06);
        color: var(--text);
      }

      /* 로딩 오버레이 완전 제거 */
      #loading-overlay {
        display: none !important;
      }

      /* MD: “페이지 박스” 제거 + A4 원본 크기 고정(스케일 없음) */
      #doc-page {
        width: 794px; /* A4 @ 96dpi */
        height: 1123px;
        margin: 0 auto;
        background: transparent; /* 박스감 제거 */
        border: 0;
        border-radius: 0;
        box-shadow: none;
        overflow: hidden;
      }

      /* 문서뷰어 내부는 스크롤로만 이동 */
      #doc-stage {
        overflow: auto;
      }

      /* 업로드 책갈피 탭 (펼친 상태: 패널 바깥으로 튀어나옴) */
      .upload-tab {
        position: absolute;
        top: 18px;
        right: -22px; /* 바깥으로 튀어나오게 */
        height: 38px;
        padding: 0 12px;

        display: inline-flex;
        align-items: center;
        justify-content: center;

        border-radius: 999px;
        border: 1px solid rgba(212, 212, 216, 1);
        background: rgba(255, 255, 255, 0.96);
        box-shadow: 0 10px 25px rgba(15, 23, 42, 0.12);

        font-size: 12px;
        font-weight: 900;
        color: #111827;
        cursor: pointer;
        user-select: none;
      }

      /* 접힌 상태: 화면 왼쪽에 고정 탭(>>>). 레이아웃 밖으로 */
      #btn-upload-expand {
        position: fixed;
        left: 0;
        top: 120px;
        z-index: 50;

        height: 40px;
        padding: 0 14px;

        display: none; /* 기본 숨김 */
        align-items: center;
        justify-content: center;

        border-radius: 0 999px 999px 0;
        border: 1px solid rgba(212, 212, 216, 1);
        border-left: 0;
        background: rgba(255, 255, 255, 0.96);
        box-shadow: 0 10px 25px rgba(15, 23, 42, 0.12);

        font-size: 12px;
        font-weight: 900;
        color: #111827;
        cursor: pointer;
        user-select: none;
      }

      /* 접혔을 때만 펼치기 탭 표시 */
      #layout-grid.upload-collapsed #btn-upload-expand {
        display: inline-flex;
      }

      /* 접힘(데스크탑) */
      @media (min-width: 1024px) {
        #layout-grid.upload-collapsed {
          grid-template-columns: 0px 1fr 520px !important;
        }
        #layout-grid.upload-collapsed #left-panel {
          transform: translateX(-120%);
          opacity: 0;
          pointer-events: none;
        }
        #left-panel {
          transition: transform 160ms ease, opacity 160ms ease;
        }
      }

      /* 정규식 유형별 */
      .pii-box[data-source='regex'][data-kind='주민등록번호'] {
        --pii-bg: rgba(190, 18, 60, 0.1);
        --pii-bd: #be123c;
      }
      .pii-box[data-source='regex'][data-kind='외국인등록번호'] {
        --pii-bg: rgba(194, 65, 12, 0.1);
        --pii-bd: #c2410c;
      }
      .pii-box[data-source='regex'][data-kind='카드번호'] {
        --pii-bg: rgba(180, 83, 9, 0.1);
        --pii-bd: #b45309;
      }
      .pii-box[data-source='regex'][data-kind='계좌번호'] {
        --pii-bg: rgba(161, 98, 7, 0.1);
        --pii-bd: #a16207;
      }
      .pii-box[data-source='regex'][data-kind='전화번호'] {
        --pii-bg: rgba(3, 105, 161, 0.1);
        --pii-bd: #0369a1;
      }
      .pii-box[data-source='regex'][data-kind='이메일'] {
        --pii-bg: rgba(67, 56, 202, 0.1);
        --pii-bd: #4338ca;
      }
      .pii-box[data-source='regex'][data-kind='여권번호'] {
        --pii-bg: rgba(15, 118, 110, 0.1);
        --pii-bd: #0f766e;
      }
      .pii-box[data-source='regex'][data-kind='운전면허번호'] {
        --pii-bg: rgba(4, 120, 87, 0.1);
        --pii-bd: #047857;
      }

      /* NER 라벨별 */
      .pii-box[data-source='ner'][data-label='PS'] {
        --pii-bg: rgba(8, 145, 178, 0.1);
        --pii-bd: #0891b2;
      }
      .pii-box[data-source='ner'][data-label='LC'] {
        --pii-bg: rgba(5, 150, 105, 0.1);
        --pii-bd: #059669;
      }
      .pii-box[data-source='ner'][data-label='OG'] {
        --pii-bg: rgba(109, 40, 217, 0.1);
        --pii-bd: #6d28d9;
      }

      /* 북마크 */
      .bm {
        position: relative;
        display: block;
        width: 100%;
        text-align: left;
        padding: 9px 10px 9px 12px;
        border-radius: 0 999px 999px 0;
        border-left: 5px solid #111827;
        background: #f4f4f5;
        color: #111827;
        font-size: 12px;
        font-weight: 800;
        white-space: nowrap;
      }
      .bm:hover {
        background: #e4e4e7;
      }
      .bm[data-active='1'] {
        background: #111827;
        color: #ffffff;
        border-left-color: var(--brand);
      }

      .pill {
        display: inline-flex;
        align-items: center;
        gap: 6px;
        border-radius: 999px;
        padding: 2px 8px;
        font-size: 11px;
        font-weight: 800;
        border: 1px solid var(--border);
        background: #ffffff;
        color: #111827;
      }
      .pill[data-source='regex'] {
        border-color: rgba(3, 105, 161, 0.25);
        background: rgba(3, 105, 161, 0.08);
        color: #075985;
      }
      .pill[data-source='ner'] {
        border-color: rgba(5, 150, 105, 0.25);
        background: rgba(5, 150, 105, 0.08);
        color: #047857;
      }
    </style>
  </head>

  <body class="bg-zinc-50 text-zinc-950">
    <!-- 상단바 -->
    <header class="border-b border-zinc-200 bg-white">
      <div class="w-full px-10 py-4 flex items-center justify-between">
        <div class="flex items-center gap-3">
          <h1 class="text-xl font-extrabold tracking-tight">Eclipso</h1>
        </div>

        <!-- (호환용) 예전 버튼은 남겨두되 UI에선 안 씀 -->
        <button
          id="btn-toggle-upload"
          type="button"
          class="hidden"
          aria-hidden="true"
          tabindex="-1"
        >
          업로드 패널 숨기기
        </button>
      </div>
    </header>

    <main class="w-full px-10 py-8">
      <!-- 사진 구조: 1행(업로드/MD/매칭), 2행(리포트는 가운데+오른쪽 span) -->
      <div
        id="layout-grid"
        class="grid grid-cols-1 lg:grid-cols-[360px,1fr,520px] lg:grid-rows-[auto_auto] gap-8"
      >
        <!-- 접힌 상태에서 보이는 '펼치기 탭(>>>)' : layout-grid 안에 둬서 selector 적용 -->
        <button id="btn-upload-expand" type="button">>>></button>

        <!-- 좌측: 문서업로드 (항상 1열, 바깥 책갈피 탭 포함) -->
        <aside
          id="left-panel"
          class="relative self-start space-y-6 lg:col-start-1 lg:row-span-2"
        >
          <!-- 펼친 상태 책갈피 탭(<<<) -->
          <button
            id="btn-upload-collapse"
            type="button"
            class="upload-tab"
            title="업로드 패널 접기"
          >
            <<<
          </button>

          <section
            class="bg-white rounded-2xl border border-zinc-200 p-6 space-y-6"
          >
            <!-- 파일 업로드 -->
            <div>
              <label class="block text-sm font-bold mb-2">파일 업로드</label>

              <label
                id="dropzone"
                for="file"
                class="block cursor-pointer rounded-2xl border-2 border-dashed border-zinc-300 hover:border-zinc-400 bg-zinc-50 px-4 py-6 text-center transition"
                role="button"
                tabindex="0"
              >
                <div class="text-sm font-extrabold text-zinc-700">
                  클릭 또는 드래그
                </div>
                <div class="text-[11px] text-zinc-500 mt-1">
                  파일을 이 영역에 놓으세요
                </div>
                <div
                  id="file-name"
                  class="mt-2 text-xs text-zinc-700 font-semibold truncate"
                ></div>
              </label>

              <input
                id="file"
                type="file"
                accept=".pdf,.doc,.ppt,.xls,.hwp,.txt,.docx,.pptx,.xlsx,.hwpx,.xml"
                class="sr-only"
              />

              <div class="mt-2 flex items-start justify-between gap-3">
                <div class="text-[11px] text-zinc-500">
                  PDF · HWP/HWPX · DOC/DOCX · PPT/PPTX · XLS/XLSX
                </div>
              </div>
            </div>

            <!-- 규칙(정규식) -->
            <fieldset class="rounded-2xl border border-zinc-200 p-4">
              <legend class="px-1 text-sm font-extrabold">정규식 규칙</legend>
              <div id="rules-container" class="mt-3 space-y-2 text-sm">
                <label class="flex items-center gap-2">
                  <input type="checkbox" name="rule" value="rrn" checked />
                  <span>주민등록번호</span>
                </label>
                <label class="flex items-center gap-2">
                  <input type="checkbox" name="rule" value="fgn" checked />
                  <span>외국인등록번호</span>
                </label>
                <label class="flex items-center gap-2">
                  <input
                    type="checkbox"
                    name="rule"
                    value="phone_mobile"
                    checked
                  />
                  <span>휴대전화</span>
                </label>
                <label class="flex items-center gap-2">
                  <input
                    type="checkbox"
                    name="rule"
                    value="phone_city"
                    checked
                  />
                  <span>지역전화</span>
                </label>
                <label class="flex items-center gap-2">
                  <input type="checkbox" name="rule" value="email" checked />
                  <span>이메일</span>
                </label>
                <label class="flex items-center gap-2">
                  <input type="checkbox" name="rule" value="card" checked />
                  <span>카드번호</span>
                </label>
                <label class="flex items-center gap-2">
                  <input type="checkbox" name="rule" value="passport" checked />
                  <span>여권번호</span>
                </label>
                <label class="flex items-center gap-2">
                  <input
                    type="checkbox"
                    name="rule"
                    value="driver_license"
                    checked
                  />
                  <span>운전면허번호</span>
                </label>
              </div>
            </fieldset>

            <!-- NER -->
            <fieldset class="rounded-2xl border border-zinc-200 p-4">
              <legend class="px-1 text-sm font-extrabold">NER</legend>
              <div class="mt-3 space-y-3 text-sm">
                <label class="flex items-center gap-2">
                  <input id="ner-show-ps" type="checkbox" checked />
                  <span>이름(PS)</span>
                </label>
                <label class="flex items-center gap-2">
                  <input id="ner-show-lc" type="checkbox" checked />
                  <span>주소·지명(LC)</span>
                </label>
                <label class="flex items-center gap-2">
                  <input id="ner-show-og" type="checkbox" checked />
                  <span>기관(OG)</span>
                </label>
              </div>
            </fieldset>

            <!-- 실행 -->
            <div class="space-y-2">
              <button
                id="btn-scan"
                class="w-full px-4 py-3 rounded-xl text-white font-extrabold bg-indigo-600 hover:bg-indigo-700 transition"
              >
                탐지 실행
              </button>
            </div>

            <!-- 상태 -->
            <div
              class="rounded-xl bg-zinc-50 border border-zinc-200 px-3 py-2 text-sm"
            >
              <span id="status" class="text-zinc-700 font-semibold"
                >대기 중</span
              >
            </div>
          </section>
        </aside>

        <!-- 가운데: 문서뷰어(MD) -->
        <section class="space-y-6 min-w-0 lg:col-start-2 lg:row-start-1">
          <div
            id="doc-viewer-block"
            class="bg-white rounded-2xl border border-zinc-200 hidden lg:h-[calc(100vh-210px)]"
          >
            <div
              class="px-6 py-4 border-b border-zinc-200 flex items-center justify-between gap-3"
            >
              <div class="min-w-0">
                <div class="text-sm font-extrabold">문서뷰어(MD)</div>
                <div
                  id="doc-meta"
                  class="text-xs text-zinc-500 mt-1 break-words"
                >
                  -
                </div>
              </div>

              <!-- Prev/Next 제거 -->
              <div class="shrink-0 flex items-center gap-2">
                <span
                  id="doc-detect-count"
                  class="text-xs font-extrabold px-2 py-1 rounded-lg bg-zinc-900 text-white"
                >
                  0
                </span>

                <!-- app.js 호환용(숨김) -->
                <button
                  id="btn-page-prev"
                  type="button"
                  class="hidden"
                  aria-hidden="true"
                  tabindex="-1"
                >
                  ◀ Prev
                </button>
                <div id="doc-page-indicator" class="hidden" aria-hidden="true">
                  1 / 1
                </div>
                <button
                  id="btn-page-next"
                  type="button"
                  class="hidden"
                  aria-hidden="true"
                  tabindex="-1"
                >
                  Next ▶
                </button>
              </div>
            </div>

            <!-- A4 1:1 고정 + 내부 스크롤(박스 없음) -->
            <div id="doc-stage" class="p-6 h-[calc(100%-69px)]">
              <div id="doc-page">
                <div id="doc-viewer" class="doc-md p-[18px]"></div>
              </div>
            </div>
          </div>
        </section>

        <!-- 오른쪽: 매칭결과(사이즈 고정 + 내부 스크롤) -->
        <section class="space-y-6 min-w-0 lg:col-start-3 lg:row-start-1">
          <div
            id="detect-block"
            class="bg-white rounded-2xl border border-zinc-200 hidden lg:h-[calc(100vh-210px)]"
          >
            <div
              class="px-6 py-4 border-b border-zinc-200 flex items-center justify-between"
            >
              <div>
                <div class="text-sm font-extrabold">매칭결과</div>
                <div id="detect-sub" class="text-xs text-zinc-500 mt-1">-</div>
              </div>
              <div class="flex items-center gap-2">
                <span
                  id="detect-badge"
                  class="text-xs font-extrabold px-2 py-1 rounded-lg bg-zinc-900 text-white"
                  >0</span
                >
              </div>
            </div>

            <div class="p-6 h-[calc(100%-69px)] overflow-auto">
              <div class="min-w-0">
                <input
                  id="detect-search"
                  type="text"
                  placeholder="탐지 텍스트 검색"
                  class="w-full text-sm border border-zinc-300 rounded-xl px-3 py-2"
                />
                <div id="bookmark-items" class="mt-3 space-y-2"></div>
              </div>
            </div>
          </div>
        </section>

        <!-- 아래: 평가리포트(가운데+오른쪽 span) -->
        <div
          id="stats-report-block"
          class="bg-white rounded-2xl border border-zinc-200 hidden min-w-0 lg:col-start-2 lg:col-span-2 lg:row-start-2"
        >
          <div
            class="px-6 py-4 flex items-start justify-between gap-4 border-b border-zinc-200"
          >
            <div class="min-w-0">
              <h2 class="font-extrabold">평가리포트</h2>
              <div
                id="stats-subtitle"
                class="text-sm text-zinc-500 mt-1 break-words"
              >
                -
              </div>
            </div>
            <div class="shrink-0 flex items-center gap-2">
              <button
                id="btn-stats-download"
                type="button"
                class="text-xs px-3 py-2 rounded-xl bg-indigo-600 text-white hover:bg-indigo-700 transition font-extrabold"
              >
                리포트 다운로드
              </button>
              <button
                id="btn-stats-json-toggle"
                type="button"
                class="text-xs px-3 py-2 rounded-xl border border-zinc-300 hover:bg-zinc-50 transition font-extrabold"
              >
                JSON
              </button>
            </div>
          </div>

          <div class="p-6 space-y-6">
            <!-- 리포트 내용(기존 그대로) -->
            <div class="grid grid-cols-1 sm:grid-cols-2 xl:grid-cols-4 gap-4">
              <div class="rounded-2xl border border-zinc-200 p-4 bg-zinc-50">
                <div class="text-xs text-zinc-500 font-bold">민감정보 비율</div>
                <div class="mt-1 flex items-end justify-between gap-3">
                  <div
                    id="stats-risk-score"
                    class="text-3xl font-extrabold tracking-tight"
                  >
                    0
                  </div>
                  <div class="text-xs text-zinc-500 font-bold">/ 100</div>
                </div>
                <div class="mt-3 h-2 rounded bg-zinc-200 overflow-hidden">
                  <div
                    id="stats-risk-meter"
                    class="h-2"
                    style="width: 0%; background-color: #0f172a"
                  ></div>
                </div>
                <div
                  id="stats-risk-note"
                  class="mt-2 text-[11px] text-zinc-500"
                >
                  -
                </div>
              </div>

              <div class="rounded-2xl border border-zinc-200 p-4">
                <div class="text-xs text-zinc-500 font-bold">
                  총 탐지 (Unique)
                </div>
                <div
                  id="stats-total-unique"
                  class="mt-1 text-3xl font-extrabold tracking-tight"
                >
                  0
                </div>
                <div class="mt-2 text-[11px] text-zinc-500">
                  <span class="text-zinc-400">Raw:</span>
                  <span id="stats-total-raw">0</span>
                  <span class="mx-1 text-zinc-300">|</span>
                  <span class="text-zinc-400">Overlap:</span>
                  <span id="stats-overlap-rate">0%</span>
                </div>
                <div class="mt-3 pt-3 border-t border-zinc-100">
                  <div class="flex items-center gap-4 text-[11px]">
                    <div>
                      <span class="text-zinc-400">정규식:</span>
                      <span
                        id="stats-regex-unique"
                        class="ml-1 font-extrabold text-zinc-950"
                        >0</span
                      >
                    </div>
                    <div>
                      <span class="text-zinc-400">NER:</span>
                      <span
                        id="stats-ner-unique"
                        class="ml-1 font-extrabold text-zinc-950"
                        >0</span
                      >
                    </div>
                  </div>
                </div>
              </div>

              <div class="rounded-2xl border border-zinc-200 p-4">
                <div class="text-xs text-zinc-500 font-bold">정규식 검증</div>
                <div class="mt-2 flex items-center gap-2">
                  <span
                    class="text-[11px] px-2 py-1 rounded-full border border-emerald-200 bg-emerald-50 text-emerald-700 font-extrabold"
                  >
                    OK <span id="stats-regex-ok" class="font-mono">0</span>
                  </span>
                  <span
                    class="text-[11px] px-2 py-1 rounded-full border border-rose-200 bg-rose-50 text-rose-700 font-extrabold"
                  >
                    FAIL <span id="stats-regex-fail" class="font-mono">0</span>
                  </span>
                </div>
                <div class="mt-3 text-[11px] text-zinc-500 font-bold">
                  FAIL 원인
                </div>
                <div
                  id="stats-fail-top"
                  class="mt-1 text-[12px] text-zinc-950 leading-relaxed"
                >
                  -
                </div>
                <div class="mt-2 text-[11px] text-zinc-500">
                  valid=false 항목만 집계
                </div>
              </div>

              <div class="rounded-2xl border border-zinc-200 p-4">
                <div class="text-xs text-zinc-500 font-bold">
                  NER 평균 Score
                </div>
                <div
                  id="stats-ner-avg"
                  class="mt-1 text-sm font-extrabold text-zinc-950"
                >
                  PS - / LC - / OG -
                </div>
                <div class="mt-2 text-[11px] text-zinc-500">
                  선택된 라벨만 반영
                </div>
              </div>
            </div>

            <div class="grid grid-cols-1 xl:grid-cols-2 gap-4">
              <div class="rounded-2xl border border-zinc-200 p-4">
                <div class="text-xs text-zinc-500 font-bold">정책</div>
                <div class="mt-2">
                  <div class="text-[12px] text-zinc-500 mb-1 font-bold">
                    정규식 규칙
                  </div>
                  <div
                    id="stats-policy-rules"
                    class="flex flex-wrap gap-1"
                  ></div>
                </div>
                <div class="mt-3">
                  <div class="text-[12px] text-zinc-500 mb-1 font-bold">
                    NER 라벨
                  </div>
                  <div
                    id="stats-policy-nerlabels"
                    class="flex flex-wrap gap-1"
                  ></div>
                </div>
              </div>

              <div class="rounded-2xl border border-zinc-200 p-4">
                <div class="text-xs text-zinc-500 font-bold">처리 시간</div>
                <div class="mt-2 rounded-xl border border-zinc-200">
                  <table class="min-w-full text-sm">
                    <thead>
                      <tr class="border-b bg-zinc-50">
                        <th class="text-left py-2 px-3">Step</th>
                        <th class="text-right py-2 px-3">Time</th>
                      </tr>
                    </thead>
                    <tbody>
                      <tr class="border-b">
                        <td class="py-2 px-3">extract</td>
                        <td
                          id="t-extract"
                          class="py-2 px-3 text-right font-mono"
                        >
                          -
                        </td>
                      </tr>
                      <tr class="border-b">
                        <td class="py-2 px-3">match</td>
                        <td id="t-match" class="py-2 px-3 text-right font-mono">
                          -
                        </td>
                      </tr>
                      <tr class="border-b">
                        <td class="py-2 px-3">ner</td>
                        <td id="t-ner" class="py-2 px-3 text-right font-mono">
                          -
                        </td>
                      </tr>
                      <tr class="border-b">
                        <td class="py-2 px-3">redact</td>
                        <td
                          id="t-redact"
                          class="py-2 px-3 text-right font-mono"
                        >
                          -
                        </td>
                      </tr>
                      <tr>
                        <td class="py-2 px-3 font-extrabold">total</td>
                        <td
                          id="t-total"
                          class="py-2 px-3 text-right font-mono font-extrabold"
                        >
                          -
                        </td>
                      </tr>
                    </tbody>
                  </table>
                </div>
              </div>
            </div>

            <div class="grid grid-cols-1 xl:grid-cols-2 gap-6">
              <div>
                <div class="text-sm font-extrabold mb-2">유형별 건수</div>
                <div class="rounded-xl border border-zinc-200">
                  <table class="min-w-full text-sm">
                    <thead>
                      <tr class="border-b bg-zinc-50">
                        <th class="text-left py-2 px-3">Type</th>
                        <th class="text-right py-2 px-3">Count</th>
                      </tr>
                    </thead>
                    <tbody id="stats-by-kind-rows"></tbody>
                  </table>
                </div>
              </div>
              <div>
                <div class="text-sm font-extrabold mb-2">라벨별 건수</div>
                <div class="rounded-xl border border-zinc-200">
                  <table class="min-w-full text-sm">
                    <thead>
                      <tr class="border-b bg-zinc-50">
                        <th class="text-left py-2 px-3">Label</th>
                        <th class="text-right py-2 px-3">Count</th>
                      </tr>
                    </thead>
                    <tbody id="stats-by-label-rows"></tbody>
                  </table>
                </div>
              </div>
            </div>

            <pre
              id="stats-json"
              class="hidden text-xs bg-zinc-50 border border-zinc-200 rounded-xl p-3 overflow-auto"
            ></pre>
          </div>
        </div>
      </div>
    </main>

    <!-- (남겨두되 CSS로 완전 비활성화됨) -->
    <div
      id="loading-overlay"
      class="hidden"
      aria-live="polite"
      aria-busy="true"
    >
      <div class="lo-card">
        <div id="loading-text" class="lo-text">동작 중...</div>
      </div>
    </div>

    <!-- 업로드 책갈피 토글만 -->
    <script>
      ;(() => {
        const grid = document.getElementById('layout-grid')
        const btnCollapse = document.getElementById('btn-upload-collapse')
        const btnExpand = document.getElementById('btn-upload-expand')

        if (grid) grid.classList.remove('upload-collapsed')

        function setCollapsed(v) {
          if (!grid) return
          grid.classList.toggle('upload-collapsed', !!v)
        }

        btnCollapse?.addEventListener('click', () => setCollapsed(true))
        btnExpand?.addEventListener('click', () => setCollapsed(false))
      })()
    </script>

    <!-- 앱 스크립트 -->
    <script type="module" src="./app.js"></script>
  </body>
</html>
